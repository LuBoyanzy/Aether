# 测试用例生成规范（Playwright）

## 目标
- 覆盖每个功能的核心流程、边界场景与异常处理。
- 稳定、可重复、可回归，优先可维护性与可读性。

## 目录结构（建议）
- 按导航或模块分目录，按 API / UI 分层拆分用例：
  - `tests/api-tests/api.spec.ts`
  - `tests/api-tests/ui.spec.ts`
- 旧目录 `tests/playright/` 逐步迁移到新结构，新增用例统一使用上述目录。

## 分层原则
- **API 层**：用 `APIRequestContext` 做数据准备/清理与接口断言。
- **UI 层**：覆盖关键用户路径与页面呈现（按钮、表单、表格、状态等）。
- **禁止**：仅用 UI 覆盖所有场景，或仅用 API 替代 UI 交互验证。

## 生成流程
1. 阅读后端接口实现（禁止猜测字段与返回格式）。
2. 先写 API 用例（创建/查询/更新/删除/执行）。
3. 再写 UI 用例（入口、导航、表单、列表、可视化、状态更新）。
4. 补充清理与回滚逻辑。

## 用例要求
- 每个功能最少覆盖：**创建、查询、更新、删除、执行/触发、历史/日志**。
- 全局配置类用例必须**读取旧值→修改→保存→恢复旧值**。
- 仅在必要时新增测试数据，且必须在测试结束时清理。

## 选择器与稳定性
- 优先 `getByRole` + 可访问名称；避免依赖 CSS 类名。
- 必须在操作前 `expect().toBeVisible()`，禁止盲等。
- 弹窗/确认框必须使用 `waitForEvent("dialog")` 明确处理。

## 环境变量（示例）
- `PLAYWRIGHT_BASE_URL`
- `PLAYWRIGHT_EMAIL`
- `PLAYWRIGHT_PASSWORD`
- `PLAYWRIGHT_CASE_URL`

## 禁止事项
- 不自动启动前后端服务。
- 不吞异常；失败要保留完整错误信息。
- 不猜测后端接口结构，必须先查后端代码。
