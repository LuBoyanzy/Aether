# Repository Guidelines

**编写代码时必须要遵循本项目是 go 语言，使用的 gin 框架，关于 go 语言的规范文档在项目根目录.codex/ 文件夹下的 Go.md 文档中**
**在使用/review 命令后，使用中文报告我**

# 最优先原则

**不要自动进行 git 提交**
**使用中文输出，每写完一个小点或者一个小模块就说一下你干吗什么，这段代码是干什么用的**
**全程使用中文交流，你的思考和对话都是！！！**
**注释用中文写！！！**

## 重要规则

**不要自动启动前后端服务** - 用户会自己启动前后端服务，请勿主动运行以下命令：

# 规范化项目开发工作流 (Project Development Workflow SOP)

## 1. 核心理念 (Core Philosophy)

本规范旨在定义一套高标准、可复用的软件工程标准作业程序 (SOP)。我们的核心理念是 **“思维链驱动 (Chain of Thought)”** 和 **“白盒交付”**。

- **思维链驱动**: 严禁盲目动手，任何操作前必须经过严密的逻辑推理和方案权衡。
- **白盒交付**: 代码不仅要能运行，其内部逻辑、边界处理和设计意图必须清晰可见。
- **简单可控**: 始终选择最简单、最可控的解决方案，抵制过度设计。

## 2. 阶段一：深度洞察与需求分析 (Insight & Analysis)

在编写第一行代码之前，必须完成以下动作：

### 2.1 全局背景扫描

- **文档阅读**: 强制阅读项目根目录下的 `README.md`、架构文档及相关接口文档。
- **代码审计**: 快速浏览现有核心代码结构，理解分层逻辑、命名习惯和公共组件，确保新代码与整体风格一致。
- **消除盲区**: 对于不熟悉的业务名词或技术细节，必须先查阅资料或询问清楚，严禁基于猜测开发。

### 2.2 用户视角代入

- **场景模拟**: 不仅是执行者，更是产品经理。站在最终用户的角度思考：“这个功能真的好用吗？”
- **需求补全**: 识别用户未表达清晰的隐性需求（如：加载时的 Loading 态、网络异常时的重试机制、数据为空时的缺省页）。
- **边缘情况预演**: 思考极端输入、并发场景、资源不足等情况下的系统表现。

## 3. 阶段二：系统设计与任务规划 (Design & Planning)

此阶段的目标是将模糊的需求转化为清晰、可执行的技术方案。

### 3.1 方案权衡 (Trade-off Analysis)

- **多方案对比**: 至少构思两种实现方案，并对比其优缺点（性能、复杂度、可维护性）。
- **质疑自我**: “这真的是最佳方案吗？”、“是否引入了不必要的复杂性？”。
- **技术选型**: 优先使用项目已有的库和模式，避免引入重复的依赖。

### 3.2 架构与接口设计

- **SOLID 原则**: 检查类和函数的设计是否符合单一职责、开闭原则等。
- **分层设计**: 明确 Controller、Service、Repository 等各层的职责边界，严禁逻辑穿透。
- **防御式设计**: 设计输入校验规则（白名单机制）、异常捕获策略和日志记录点。

### 3.3 原子化任务拆解 (Atomized Todo List)

- **任务清单**: 将复杂需求拆解为不超过 2 小时工作量的原子任务。
- **状态追踪**: 使用 Todo List 工具管理进度，确保每一步都有迹可循。

## 4. 阶段三：高质量编码 (Implementation)

编码是设计的具象化，核心要求是“可读性优先”。

### 4.1 编码执行

- **命名即文档**: 变量、函数、类名必须清晰表意，拒绝 `temp`, `data`, `info` 等模糊命名。
- **逻辑解耦**: 保持函数短小（建议 < 50 行），嵌套层级不超过 3 层。
- **异常处理**: 严禁静默吞掉异常。必须捕获具体异常，保留堆栈信息，并记录上下文（Context）。

### 4.2 注释与自文档化

- **Why > What**: 注释解释“为什么这么做”（设计意图、特殊业务逻辑），而不是“做了什么”（代码本身已表达）。
- **魔法数处理**: 所有的字面量（数字、字符串）必须提取为具名常量。

### 4.3 安全编码

- **输入清洗**: 对所有外部输入视为不可信，进行严格校验。
- **防注入**: 使用参数化查询防范 SQL 注入，使用转义防范 XSS。
- **敏感脱敏**: 日志中严禁打印明文密码、密钥或用户隐私信息。

## 5. 阶段四：验证与质量门禁 (Verification & Quality Gate)

交付前的最后一道防线。

### 5.1 自动化测试

- **单元测试**: 覆盖核心业务逻辑和边界条件，确保测试可重复执行。
- **本地回归**: 修改代码后，必须运行相关模块的测试，确保未引入回归缺陷。

### 5.2 自我审查 (Self-Review)

在提交代码前，对照以下清单自查：

- [ ] 是否遵循了项目的代码风格？
- [ ] 是否处理了所有可能的 `null` 指针或 `undefined`？
- [ ] 是否释放了打开的资源（文件、连接、锁）？
- [ ] 错误日志是否清晰且包含足够排查的信息？

## 6. 阶段五：交付与复盘 (Delivery & Review)

- **文档同步**: 任何代码变更如果影响了 API 接口、配置项或架构设计，必须同步更新相关文档（README, Swagger 等）。
- **技术债清理**: 如果在开发过程中采用了临时方案（Workaround），必须记录 TODO 注释或创建后续优化任务。
- **知识沉淀**: 总结本次开发中遇到的坑和解决方案，更新到团队知识库。

---

**总结**: 优秀的工作流不是限制，而是保障。通过坚持“先想后做”和“全链路质量意识”，我们将持续交付高质量、可维护的软件产品。
